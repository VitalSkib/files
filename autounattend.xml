<?xml version="1.0" encoding="utf-8"?>
<unattend xmlns="urn:schemas-microsoft-com:unattend" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State">
	<settings pass="offlineServicing"/>
	<settings pass="windowsPE">
		<component name="Microsoft-Windows-International-Core-WinPE" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<InputLocale>0409:00000409;0419:00000419</InputLocale>
			<SystemLocale>en-US</SystemLocale>
			<UILanguage>en-US</UILanguage>
			<UserLocale>ru-KZ</UserLocale>
		</component>
		<component name="Microsoft-Windows-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<DiskConfiguration>
				<WillShowUI>OnError</WillShowUI>
			</DiskConfiguration>
			<ImageInstall>
				<OSImage>
					<WillShowUI>OnError</WillShowUI>
				</OSImage>
			</ImageInstall>
		</component>
		<component name="Microsoft-Windows-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<ImageInstall>
				<OSImage>
					<InstallFrom>
						<MetaData wcm:action="add">
							<Key>/IMAGE/NAME</Key>
							<Value>Windows 11 Pro</Value>
						</MetaData>
					</InstallFrom>
					<Compact>true</Compact>
				</OSImage>
			</ImageInstall>
			<UserData>
				<ProductKey>
					<Key>W269N-WFGWX-YVC9B-4J6C9-T83GX</Key>
					<WillShowUI>OnError</WillShowUI>
				</ProductKey>
				<AcceptEula>true</AcceptEula>
			</UserData>
			<UseConfigurationSet>true</UseConfigurationSet>
			<RunSynchronous>
				<RunSynchronousCommand wcm:action="add">
					<Order>1</Order>
					<Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassTPMCheck /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>2</Order>
					<Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassSecureBootCheck /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>3</Order>
					<Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassRAMCheck /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>4</Order>
					<Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassStorageCheck /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>5</Order>
					<Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassCPUCheck /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>6</Order>
					<Path>reg.exe add "HKLM\SYSTEM\Setup\LabConfig" /v BypassDiskCheck /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>7</Order>
					<Path>reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OOBE" /v BypassNRO /t REG_DWORD /d 1 /f</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>8</Order>
					<Path>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-NetAdapter | Disable-NetAdapter -Confirm:$false; New-Item -Path 'C:\UnattendLogs' -ItemType Directory -Force"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>9</Order>
					<Path>powershell.exe -NoProfile -WindowStyle Hidden -Command "foreach($d in 'C','D','E','F','G','H','I','J','K'){$src=Join-Path ($d+':') 'sources\sxs';if(Test-Path $src\*.cab){dism /Online /Enable-Feature /FeatureName:NetFx3 /All /LimitAccess /Source:$src;break}}"</Path>
				</RunSynchronousCommand>
			</RunSynchronous>
		</component>
	</settings>
	<settings pass="generalize"/>
	<settings pass="specialize">
		<component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<ComputerName>SWR-PC</ComputerName>
			<ProductKey>W269N-WFGWX-YVC9B-4J6C9-T83GX</ProductKey>
			<TimeZone>Qyzylorda Standard Time</TimeZone>
			<SkipRearm>1</SkipRearm>
		</component>
		<component name="Microsoft-Windows-Deployment" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<RunSynchronous>
				<RunSynchronousCommand wcm:action="add">
					<Order>1</Order>
					<Path>powershell.exe -WindowStyle "Hidden" -NoProfile -Command "$xml = [xml]::new(); $xml.Load('C:\Windows\Panther\unattend.xml'); $sb = [scriptblock]::Create( $xml.unattend.Extensions.ExtractScript ); Invoke-Command -ScriptBlock $sb -ArgumentList $xml;"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>2</Order>
					<Path>powershell.exe -WindowStyle "Hidden" -ExecutionPolicy "Unrestricted" -NoProfile -File "C:\Windows\Setup\Scripts\Specialize.ps1"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>3</Order>
					<Path>reg.exe load "HKU\DefaultUser" "C:\Users\Default\NTUSER.DAT"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>4</Order>
					<Path>powershell.exe -WindowStyle "Hidden" -ExecutionPolicy "Unrestricted" -NoProfile -File "C:\Windows\Setup\Scripts\DefaultUser.ps1"</Path>
				</RunSynchronousCommand>
				<RunSynchronousCommand wcm:action="add">
					<Order>5</Order>
					<Path>reg.exe unload "HKU\DefaultUser"</Path>
				</RunSynchronousCommand>
			</RunSynchronous>
		</component>
	</settings>
	<settings pass="auditSystem"/>
	<settings pass="auditUser"/>
	<settings pass="oobeSystem">
		<component name="Microsoft-Windows-International-Core" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<InputLocale>0409:00000409;0419:00000419</InputLocale>
			<SystemLocale>en-US</SystemLocale>
			<UILanguage>en-US</UILanguage>
			<UserLocale>ru-KZ</UserLocale>
		</component>
		<component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
			<UserAccounts>
				<LocalAccounts>
					<LocalAccount wcm:action="add">
						<Name>SWR47</Name>
						<DisplayName>SWR47</DisplayName>
						<Group>Administrators</Group>
						<Password>
							<Value>509490</Value>
							<PlainText>true</PlainText>
						</Password>
					</LocalAccount>
				</LocalAccounts>
			</UserAccounts>
			<AutoLogon>
				<Username>SWR47</Username>
				<Enabled>true</Enabled>
				<LogonCount>1</LogonCount>
				<Password>
					<Value>509490</Value>
					<PlainText>true</PlainText>
				</Password>
			</AutoLogon>
			<OOBE>
				<ProtectYourPC>3</ProtectYourPC>
				<HideEULAPage>true</HideEULAPage>
				<HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>
				<HideOnlineAccountScreens>true</HideOnlineAccountScreens>
			</OOBE>
			<FirstLogonCommands>
				<SynchronousCommand wcm:action="add">
					<Order>1</Order>
					<CommandLine>powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "Get-NetAdapter | Enable-NetAdapter -Confirm:$false"</CommandLine>
				</SynchronousCommand>
				<SynchronousCommand wcm:action="add">
					<Order>2</Order>
					<CommandLine>powershell.exe -WindowStyle "Hidden" -ExecutionPolicy "Unrestricted" -NoProfile -File "C:\Windows\Setup\Scripts\FirstLogon.ps1"</CommandLine>
				</SynchronousCommand>
				<SynchronousCommand wcm:action="add">
					<Order>3</Order>
					<CommandLine>powershell.exe -WindowStyle "Hidden" -ExecutionPolicy "Unrestricted" -NoProfile -File "C:\Windows\Setup\Scripts\UserOnce.ps1"</CommandLine>
				</SynchronousCommand>
			</FirstLogonCommands>
		</component>
	</settings>
	<Extensions xmlns="https://schneegans.de/windows/unattend-generator/">
		<ExtractScript>
param(
    [xml] $Document
);

foreach( $file in $Document.unattend.Extensions.File ) {
    $path = [System.Environment]::ExpandEnvironmentVariables( $file.GetAttribute( 'path' ) );
    mkdir -Path( $path | Split-Path -Parent ) -ErrorAction 'SilentlyContinue';
    $encoding = switch( [System.IO.Path]::GetExtension( $path ) ) {
        { $_ -in '.ps1', '.xml' } { [System.Text.Encoding]::UTF8; }
        { $_ -in '.reg', '.vbs', '.js' } { [System.Text.UnicodeEncoding]::new( $false, $true ); }
        default { [System.Text.Encoding]::Default; }
    };
    $bytes = $encoding.GetPreamble() + $encoding.GetBytes( $file.InnerText.Trim() );
    [System.IO.File]::WriteAllBytes( $path, $bytes );
}
		</ExtractScript>
		<File path="C:\Windows\Setup\Scripts\RemovePackages.ps1">
$selectors = @(
	'Microsoft.Microsoft3DViewer',
	'Microsoft.BingSearch',
	'Microsoft.WindowsCamera',
	'Clipchamp.Clipchamp',
	'Microsoft.Copilot',
	'Microsoft.549981C3F5F10',
	'MicrosoftCorporationII.MicrosoftFamily',
	'Microsoft.Edge.GameAssist',
	'Microsoft.GetHelp',
	'Microsoft.Getstarted',
	'microsoft.windowscommunicationsapps',
	'Microsoft.WindowsMaps',
	'Microsoft.MixedReality.Portal',
	'Microsoft.BingNews',
	'Microsoft.MicrosoftOfficeHub',
	'Microsoft.Office.OneNote',
	'Microsoft.OutlookForWindows',
	'Microsoft.MSPaint',
	'Microsoft.People',
	'Microsoft.PowerAutomateDesktop',
	'MicrosoftCorporationII.QuickAssist',
	'Microsoft.SkypeApp',
	'Microsoft.ScreenSketch',
	'Microsoft.MicrosoftSolitaireCollection',
	'Microsoft.MicrosoftStickyNotes',
	'MicrosoftTeams',
	'MSTeams',
	'Microsoft.Todos',
	'Microsoft.WindowsSoundRecorder',
	'Microsoft.Wallet',
	'Microsoft.Xbox.TCUI',
	'Microsoft.XboxApp',
	'Microsoft.XboxGameOverlay',
	'Microsoft.XboxGamingOverlay',
	'Microsoft.XboxIdentityProvider',
	'Microsoft.XboxSpeechToTextOverlay',
	'Microsoft.GamingApp',
	'Microsoft.YourPhone',
	'Microsoft.ZuneMusic',
	'Microsoft.ZuneVideo'
);
$getCommand = {
  Get-AppxProvisionedPackage -Online;
};
$filterCommand = {
  $_.DisplayName -eq $selector;
};
$removeCommand = {
  [CmdletBinding()]
  param(
    [Parameter( Mandatory, ValueFromPipeline )]
    $InputObject
  );
  process {
    $InputObject | Remove-AppxProvisionedPackage -AllUsers -Online -ErrorAction 'Continue';
  }
};
$type = 'Package';
$logfile = 'C:\UnattendLogs\RemovePackages.log';
try {
	$installed = &amp; $getCommand;
	foreach( $selector in $selectors ) {
		$result = [ordered] @{
			Selector = $selector;
		};
		$found = $installed | Where-Object -FilterScript $filterCommand;
		if( $found ) {
			$result.Output = $found | &amp; $removeCommand;
			if( $? ) {
				$result.Message = "$type removed.";
			} else {
				$result.Message = "$type not removed.";
				$result.Error = $Error[0];
			}
		} else {
			$result.Message = "$type not installed.";
		}
		$result | ConvertTo-Json -Depth 3 -Compress | Out-File -FilePath $logfile -Append -Encoding utf8;
	}
} catch {
	"Error: $($_.Exception.Message)" | Out-File -FilePath $logfile -Append -Encoding utf8;
}
		</File>
		<File path="C:\Windows\Setup\Scripts\RemoveCapabilities.ps1">
$selectors = @(
	'Print.Fax.Scan',
	'Language.Handwriting',
	'Browser.InternetExplorer',
	'MathRecognizer',
	'OneCoreUAP.OneSync',
	'OpenSSH.Client',
	'Microsoft.Windows.PowerShell.ISE',
	'App.Support.QuickAssist',
	'Language.Speech',
	'Language.TextToSpeech',
	'App.StepsRecorder',
	'Hello.Face.18967',
	'Hello.Face.Migration.18967',
	'Hello.Face.20134',
	'Media.WindowsMediaPlayer'
);
$getCommand = {
  Get-WindowsCapability -Online | Where-Object -Property 'State' -NotIn -Value @(
    'NotPresent',
    'Removed'
  );
};
$filterCommand = {
  ($_.Name -split '~')[0] -eq $selector;
};
$removeCommand = {
  [CmdletBinding()]
  param(
    [Parameter( Mandatory, ValueFromPipeline )]
    $InputObject
  );
  process {
    $InputObject | Remove-WindowsCapability -Online -ErrorAction 'Continue';
  }
};
$type = 'Capability';
$logfile = 'C:\UnattendLogs\RemoveCapabilities.log';
try {
	$installed = &amp; $getCommand;
	foreach( $selector in $selectors ) {
		$result = [ordered] @{
			Selector = $selector;
		};
		$found = $installed | Where-Object -FilterScript $filterCommand;
		if( $found ) {
			$result.Output = $found | &amp; $removeCommand;
			if( $? ) {
				$result.Message = "$type removed.";
			} else {
				$result.Message = "$type not removed.";
				$result.Error = $Error[0];
			}
		} else {
			$result.Message = "$type not installed.";
		}
		$result | ConvertTo-Json -Depth 3 -Compress | Out-File -FilePath $logfile -Append -Encoding utf8;
	}
} catch {
	"Error: $($_.Exception.Message)" | Out-File -FilePath $logfile -Append -Encoding utf8;
}
		</File>
		<File path="C:\Windows\Setup\Scripts\RemoveFeatures.ps1">
$selectors = @(
	'MediaPlayback',
	'Microsoft-RemoteDesktopConnection',
	'Recall',
	'Microsoft-SnippingTool'
);
$getCommand = {
  Get-WindowsOptionalFeature -Online | Where-Object -Property 'State' -NotIn -Value @(
    'Disabled',
    'DisabledWithPayloadRemoved'
  );
};
$filterCommand = {
  $_.FeatureName -eq $selector;
};
$removeCommand = {
  [CmdletBinding()]
  param(
    [Parameter( Mandatory, ValueFromPipeline )]
    $InputObject
  );
  process {
    $InputObject | Disable-WindowsOptionalFeature -Online -NoRestart -ErrorAction 'Continue';
  }
};
$type = 'Feature';
$logfile = 'C:\UnattendLogs\RemoveFeatures.log';
try {
	$installed = &amp; $getCommand;
	foreach( $selector in $selectors ) {
		$result = [ordered] @{
			Selector = $selector;
		};
		$found = $installed | Where-Object -FilterScript $filterCommand;
		if( $found ) {
			$result.Output = $found | &amp; $removeCommand;
			if( $? ) {
				$result.Message = "$type removed.";
			} else {
				$result.Message = "$type not removed.";
				$result.Error = $Error[0];
			}
		} else {
			$result.Message = "$type not installed.";
		}
		$result | ConvertTo-Json -Depth 3 -Compress | Out-File -FilePath $logfile -Append -Encoding utf8;
	}
} catch {
	"Error: $($_.Exception.Message)" | Out-File -FilePath $logfile -Append -Encoding utf8;
}
		</File>
		<File path="C:\Windows\Setup\Scripts\Specialize.ps1">
$logfile = 'C:\UnattendLogs\Specialize.log';

try {
	&amp; "C:\Windows\Setup\Scripts\RemovePackages.ps1" *>> $logfile 2&gt;&amp;1
	&amp; "C:\Windows\Setup\Scripts\RemoveCapabilities.ps1" *>> $logfile 2&gt;&amp;1
	&amp; "C:\Windows\Setup\Scripts\RemoveFeatures.ps1" *>> $logfile 2&gt;&amp;1
} catch {
	"Specialize error: $($_.Exception.Message)" | Out-File -FilePath $logfile -Append -Encoding utf8
}
		</File>
		<File path="C:\Windows\Setup\Scripts\DefaultUser.ps1">
$logfile = 'C:\UnattendLogs\DefaultUser.log';

try {
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "HideFileExt" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarAl" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowTaskViewButton" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowCopilotButton" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarMn" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarDa" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "SeparateProcess" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "LaunchTo" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "MMTaskbarEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_ShowClassicMode" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_Layout" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "DisableThumbnailCache" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowAllAppsGrid" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_PinMode" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_ShowDocuments" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_ShowDownloads" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_ShowMusic" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_ShowPictures" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_ShowVideos" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_IrisRecommendations" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_TrackDocs" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_TrackProgs" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_AccountNotifications" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "LastActiveClick" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TDRDelay" /t REG_DWORD /d 60 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShortcutArrow" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "UseCompactMode" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowFileExtensions" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowHidden" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowEncryptCompressedColor" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowTypeOverlay" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "SnapAssist" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ListviewShadow" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "PersistBrowsers" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ListviewAlphaSelect" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowInfoTip" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowStatusBar" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "IconsOnly" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\DWM" /v "EnableAeroPeek" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338388Enabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338389Enabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353698Enabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-314559Enabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353696Enabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-353697Enabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v "SubscribedContent-338387Enabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Privacy" /v "TailoredExperiencesWithDiagnosticDataEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Search" /v "BingSearchEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Search" /v "CortanaConsent" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" /v "VisualFXSetting" /t REG_DWORD /d 3 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v "AppsUseLightTheme" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v "SystemUsesLightTheme" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Control Panel\Desktop" /v "AutoColorization" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows Defender" /v "DisableAntiSpyware" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Start" /v "ShowMoreTiles" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Ribbon" /v "MinimizedStateTabletModeOff" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer" /v "ShortcutArrow" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\CurrentVersion\PushNotifications" /v "NoTileApplicationNotification" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v "Enabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Siuf\Rules" /v "NumberOfSIUFInPeriod" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" /v "GlobalUserDisabled" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{C2BF9876-73F2-40BF-8DA3-708DC0E2A327}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{E5323777-F976-4f5b-9B55-B94699C46E44}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{BFA794E4-F964-4fdb-90F6-51056BFE4B44}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{D89823BA-7180-4D73-903B-7E1054EDB1A1}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{2EEF81BE-33FA-4800-9670-1CD474972C3F}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{52079E78-A92B-413F-B213-E8FE35712BE0}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{7D7E8402-7C54-4821-A34E-AEE1D3B96899}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{992AFA70-6F47-4148-B3E9-3003349C7258}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{2297E4E2-5DBE-63D5-E9B8-6765BD477AB8}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{235D2C6B-5E26-40BE-93DF-B112FCAF956B}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{6AC27878-A6FA-4155-BA85-F98F491D4F33}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{9221F3E9-4BB0-4CFB-9BBE-ACF8F569B4E1}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{E83AF229-8640-4D18-A2E3-777F2E996A1B}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{9D9E0118-1804-4F06-96E4-FE4B9B2331D5}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{E5323777-F976-4f5b-9B55-B94699C46E44}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\{C1D23ACC-752B-43E5-8448-8D0EB4A8F05D}" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\DeviceAccess\Global\LooselyCoupled" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\SYSTEM\CurrentControlSet\Control\FileSystem" /v "LongPathsEnabled" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\SYSTEM\CurrentControlSet\Control\FileSystem" /v "NtfsDisableLastAccessUpdate" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\OneDrive" /v "DisableFileSyncNgsc" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\CurrentVersion\Internet Settings" /v "ProxyEnable" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Policies\System" /v "EnableLUA" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "RemoteAssistance" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ChatIcon" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows Defender" /v "DisableAntiSpyware" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet" /v "SpynetReporting" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet" /v "SubmitSamplesConsent" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection" /v "DisableRealtimeMonitoring" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection" /v "DisableBehaviorMonitoring" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection" /v "DisableOnAccessProtection" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection" /v "DisableScanOnRealtimeEnable" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Scan" /v "DisableArchiveScanning" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Scan" /v "DisableEmailScanning" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Scan" /v "DisableScanningMappedNetworkDrivesForFullScan" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\FeatureManagement\Overrides\14\3895955085" /v "EnabledState" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\FeatureManagement\Overrides\14\3895955085" /v "EnabledStateOptions" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Classes\.tx" /v "" /t REG_SZ /d "Parsifal.Program" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Classes\.tx" /v "PerceivedType" /t REG_SZ /d "Image" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKU\DefaultUser\Software\Classes\.tx" /v "Content Type" /t REG_SZ /d "image/TX" /f *>> $logfile 2&gt;&amp;1
reg.exe delete "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Shell Extensions\Blocked" /v "{CA6CC9F1-867A-481E-951E-A28C5E4F01EA}" /f *>> $logfile 2&gt;&amp;1
reg.exe delete "HKU\DefaultUser\Software\Classes\CLSID\{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}" /f *>> $logfile 2&gt;&amp;1
reg.exe delete "HKU\DefaultUser\Software\Classes\CLSID\{f874310e-b6b7-47dc-bc84-b9e6b38f5903}" /f *>> $logfile 2&gt;&amp;1
} catch {
"DefaultUser error: $($_.Exception.Message)" | Out-File -FilePath $logfile -Append -Encoding utf8
}
		</File>
		<File path="C:\Windows\Setup\Scripts\FirstLogon.ps1">
$logfile = 'C:\UnattendLogs\FirstLogon.log';

try {
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\PriorityControl" /v "Win32PrioritySeparation" /t REG_DWORD /d 38 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v "AutoRestartShell" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "VerboseStatus" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" /v "EnableSecuritySignature" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" /v "RequireSecuritySignature" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Lsa" /v "DisableDomainCreds" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Lsa" /v "EveryoneIncludesAnonymous" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Lsa" /v "LimitBlankPasswordUse" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0" /v "NTLMMinClientSec" /t REG_DWORD /d 536870912 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0" /v "NTLMMinServerSec" /t REG_DWORD /d 536870912 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters" /v "EnablePlainTextPassword" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters" /v "EnableSecuritySignature" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters" /v "RequireSecuritySignature" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "DontDisplayLastUserName" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "LegalNoticeCaption" /t REG_SZ /d "" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "LegalNoticeText" /t REG_SZ /d "" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "scforceoption" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "ShutdownWithoutLogon" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v "undockwithoutlogon" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender" /v "DisableAntiSpyware" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\WinDefend" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v "AllowClipboardHistory" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v "EnableSmartScreen" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power" /v "HiberbootEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Power" /v "HibernateEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShortcutArrow" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\GraphicsPerfSvc" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\OneSyncSvc" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\MessagingService" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\wlpasvc" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\RetailDemo" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\WalletService" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\wisvc" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\OneSyncSvc_*" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\MessagingService_*" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ReserveManager" /v "ShippedWithReserves" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\OneDrive" /v "DisableFileSyncNgsc" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\RemoteRegistry" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\RemoteAssistance" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\CurrentVersion\Schedule\Maintenance" /v "MaintenanceDisabled" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v "TailoredExperiencesWithDiagnosticDataEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo" /v "DisabledByGroupPolicy" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v "Enabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "DisableInventory" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "DisableUAR" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config" /v "DODownloadMode" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DeliveryOptimization" /v "DODownloadMode" /t REG_DWORD /d 100 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v "SmartScreenEnabled" /t REG_SZ /d "Off" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\SmartScreen" /v "ConfigureAppInstallControlEnabled" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\SmartScreen" /v "ConfigureAppInstallControl" /t REG_SZ /d "Anywhere" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender" /v "DisableBehaviorMonitoring" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender" /v "DisableIOAVProtection" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender" /v "DisableRealtimeMonitoring" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet" /v "SubmitSamplesConsent" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet" /v "SpynetReporting" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\MRT" /v "DontOfferThroughWUAU" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\MRT" /v "DontReportInfectionInformation" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\SecurityHealthService" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v "PublishUserActivities" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\TextInput" /v "AllowLinguisticDataCollection" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" /v "DisableLocation" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" /v "DisableLocationScripting" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" /v "DisableSensors" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\LocationAndSensors" /v "DisableWindowsLocationProvider" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\lfsvc\Service\Configuration" /v "Status" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\lfsvc" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\FindMyDevice" /v "AllowFindMyDevice" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace" /v "AllowSuggestedAppsInWindowsInkWorkspace" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace" /v "AllowWindowsInkWorkspace" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\PenWorkspace" /v "PenWorkspaceButtonDesiredVisibility" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\TabletPC" /v "PreventHandwritingDataSharing" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\TabletPC" /v "PreventHandwritingDataSharing" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\HandwritingErrorReports" /v "PreventHandwritingErrorReports" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\SQMClient\Windows" /v "CEIPEnable" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v "LimitEnhancedDiagnosticDataWindowsAnalytics" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\AutoLogger\AutoLogger-Diagtrack-Listener" /v "Start" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\dmwappushservice" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\DiagTrack" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync" /v "DisableSettingSync" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\SettingSync" /v "DisableSettingSyncUserOverride" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\OneDrive" /v "DisableLibrariesDefaultSaveToOneDrive" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\OneDrive" /v "DisableFileSync" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Systray" /v "HideSystray" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appDiagnostics" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userAccountInformation" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCallHistory" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\email" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userDataTasks" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\chat" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\radios" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\bluetoothSync" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appointments" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "DisallowShaking" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "EnableBalloonTips" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\GameDVR" /v "AllowGameDVR" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\XblAuthManager" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\XblGameSave" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\xboxgip" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\XboxNetApiSvc" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v "NoUseStoreOpenWith" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v "NoNewAppAlert" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "NoStartMenuRecommendations" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v "HidePeopleBar" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v "AllowOnlineTips" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Network Connections" /v "NC_ShowSharedAccessUI" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\TabletPC" /v "PreventHandwritingDataSharing" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\TabletPC" /v "PreventHandwritingErrorReports" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo" /v "DisabledByGroupPolicy" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\EnhancedStorageDevices" /v "TCGSecurityActivationDisabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\OneSettings" /v "EnableSync" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DeviceCompatibility" /v "DisableRemoteAssistance" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessAccountInfo" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessCalendar" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessCallHistory" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessCamera" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessContacts" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessEmail" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessLocation" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessMessaging" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessMicrophone" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessMotion" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessNotifications" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessPhone" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessRadios" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessTrustedDevices" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsGetDiagnosticInfo" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsRunInBackground" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsSyncWithDevices" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppPrivacy" /v "LetAppsAccessTasks" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Biometrics" /v "Enabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CredUI" /v "DisablePasswordReveal" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\WebClient" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userNotificationListener" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\activity" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCall" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appointments" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\email" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\userDataTasks" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\chat" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\phoneCallHistory" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\radios" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\bluetoothSync" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\appDiagnostics" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\documentsLibrary" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\picturesLibrary" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\videosLibrary" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\broadFileSystemAccess" /v "Value" /t REG_SZ /d "Deny" /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d}" /v "ScenarioExecutionEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" /v "TdrDelay" /t REG_DWORD /d 60 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "LongPathsEnabled" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v "NtfsDisableLastAccessUpdate" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\OneDrive" /v "DisableFileSyncNgsc" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\OneDrive" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
taskkill /f /im OneDrive.exe *>> $logfile 2&gt;&amp;1
%SystemRoot%\SysWOW64\OneDriveSetup.exe /uninstall *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\RemoteAssistance" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\MRT" /v "DontOfferThroughWUAU" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\WpnUserService_*" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\WpnService" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{67144949-5132-4859-8036-a737b43825d8}" /v "EnabledScenarioExecutionLevel" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\WinHttp" /v "DisableWpad" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\WinHttpAutoProxySvc" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching" /v "SearchOrderConfig" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\ScheduledDiagnostics" /v "EnabledExecution" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy" /v "EnableQueryRemoteServer" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnosticsProvider\Policy" /v "DisableQueryRemoteServer" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\diagsvc" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\DusmSvc" /v "Start" /t REG_DWORD /d 4 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Privacy" /v "TailoredExperiencesWithDiagnosticDataEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{3af8b24a-4a18-4f1d-87ef-94494e8b092b}" /v "ScenarioExecutionEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{5c23dec4-4e8e-4bdb-b0cf-851126b148a0}" /v "ScenarioExecutionEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{67144949-5132-4859-8036-a737b43825d8}" /v "ScenarioExecutionEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{6c28c7e5-4269-4dc3-9b92-5ee84a7a1bc4}" /v "ScenarioExecutionEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{86432a0b-3c7d-4ddf-a89c-172faa90485d}" /v "ScenarioExecutionEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{8af052f9-3da0-4d8f-a228-7ace8c3b1034}" /v "ScenarioExecutionEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{9c5a40da-b965-4fc3-8781-88dd50a6299d}" /v "ScenarioExecutionEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{c295fbdf-34a7-49a7-ace5-3f3ab456d558}" /v "ScenarioExecutionEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{ebc25cf6-9120-4283-b972-0e5520d0000E}" /v "ScenarioExecutionEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\WDI\{ebc25cf6-9120-4283-b972-0e5520d0000F}" /v "ScenarioExecutionEnabled" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\WindowsMitigation" /v "UserPreference" /t REG_DWORD /d 3 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "FeatureSettings" /t REG_DWORD /d 3 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "FeatureSettingsOverride" /t REG_DWORD /d 3 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "FeatureSettingsOverrideMask" /t REG_DWORD /d 3 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\Dwm" /v "CompositionPolicy" /t REG_DWORD /d 2 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\Dwm" /v "ColorizationGlassAttribute" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\Dwm" /v "EnableAeroPeek" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\Dwm" /v "EnableWindowColorization" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\Dwm" /v "AccentColor" /t REG_DWORD /d 4282927692 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Accent" /v "AccentPalette" /t REG_BINARY /d 6B6B6BFF5A5A5AFF4D4D4DFF3A3A3AFF2D2D2DFF1F1F1FFF0F0F0FFF090909FF /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Accent" /v "AccentColorMenu" /t REG_DWORD /d 4281545523 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Accent" /v "StartColorMenu" /t REG_DWORD /d 4281150758 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v "EnableTransparency" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v "DisableAcrylicBackgroundOnLogon" /t REG_DWORD /d 0 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" /v "PlatformSupportMiracast" /t REG_DWORD /d 1 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" /v "DxgKrnlVersion" /t REG_DWORD /d 4354 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" /v "MinDxgKrnlVersion" /t REG_DWORD /d 20483 /f *>> $logfile 2&gt;&amp;1
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\GraphicsDrivers" /v "TdrDdiDelay" /t REG_DWORD /d 60 /f *>> $logfile 2&gt;&amp;1
} catch {
"FirstLogon error: $($_.Exception.Message)" | Out-File -FilePath $logfile -Append -Encoding utf8
}
		</File>
		<File path="C:\Windows\Setup\Scripts\UserOnce.ps1">
$logfile = 'C:\UnattendLogs\UserOnce.log';

try {
if (-not (Get-Command winget -ErrorAction SilentlyContinue)) {
    Add-AppxPackage -Path "https://github.com/microsoft/winget-cli/releases/latest/download/Microsoft.DesktopAppInstaller_8wekyb3d8bbwe.msixbundle" *>> $logfile 2&gt;&amp;1
}
winget install --id 7zip.7zip --silent --accept-package-agreements --accept-source-agreements *>> $logfile 2&gt;&amp;1
winget install --id Brave.Brave --silent --accept-package-agreements --accept-source-agreements *>> $logfile 2&gt;&amp;1
winget install --id Google.Chrome --silent --accept-package-agreements --accept-source-agreements *>> $logfile 2&gt;&amp;1
winget install --id Mozilla.Firefox.Nightly --silent --accept-package-agreements --accept-source-agreements *>> $logfile 2&gt;&amp;1
winget install --id RARLab.WinRAR --silent --accept-package-agreements --accept-source-agreements *>> $logfile 2&gt;&amp;1

Invoke-WebRequest -Uri "https://aka.ms/vs/17/release/vc_redist.x64.exe" -OutFile "$env:TEMP\vc_redist.x64.exe" *>> $logfile 2&gt;&amp;1
Start-Process -FilePath "$env:TEMP\vc_redist.x64.exe" -ArgumentList "/quiet /norestart" -Wait *>> $logfile 2&gt;&amp;1

Add-AppxPackage -Path "https://github.com/microsoft/terminal/releases/latest/download/Microsoft.WindowsTerminal_*.msixbundle" *>> $logfile 2&gt;&amp;1

Invoke-WebRequest -Uri "https://github.com/thebookisclosed/ViVe/releases/latest/download/ViVeTool-v0.*.zip" -OutFile "$env:TEMP\ViVeTool.zip" *>> $logfile 2&gt;&amp;1
Expand-Archive -Path "$env:TEMP\ViVeTool.zip" -DestinationPath "$env:ProgramFiles\ViVeTool" *>> $logfile 2&gt;&amp;1
$env:Path += ";$env:ProgramFiles\ViVeTool"

vivetool /enable /id:49402389 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:49221331 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:58988972 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:59265307 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:47205210 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:58989002 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:48433719 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:57118881 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:58381341 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:58527096 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:57156807 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:57259990 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:41118774 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:55805655 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:58778013 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:58383338 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:59270880 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:59203365 *>> $logfile 2&gt;&amp;1
vivetool /enable /id:57703775 *>> $logfile 2&gt;&amp;1

Restart-Computer -Force *>> $logfile 2&gt;&amp;1
} catch {
"UserOnce error: $($_.Exception.Message)" | Out-File -FilePath $logfile -Append -Encoding utf8
}
		</File>
	</Extensions>
</unattend>