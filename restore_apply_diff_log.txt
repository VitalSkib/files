2026-02-13 03:55:42 [INFO] Backup created: C:\UnattendLogs\autounattend_Copilot.xml.bak
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Original__C__Windows_Setup_Scripts_RemoveCapabilities.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 34 lines into C:\Windows\Setup\Scripts\RemoveCapabilities.ps1
  + 'Print.Fax.Scan';
  + 'Language.Handwriting';
  + 'Browser.InternetExplorer';
  + 'MathRecognizer';
  + 'OneCoreUAP.OneSync';
  + 'OpenSSH.Client';
  + 'App.Support.QuickAssist';
  + 'Language.Speech';
  + 'Language.TextToSpeech';
  + 'App.StepsRecorder';
  + 'Hello.Face.18967';
  + 'Hello.Face.Migration.18967';
  + 'Hello.Face.20134';
  + 'Media.WindowsMediaPlayer';
  + $installed = &amp; $getCommand;
  + foreach( $selector in $selectors ) {
  + $result = [ordered] @{
  + Selector = $selector;
  + };
  + $found = $installed | Where-Object -FilterScript $filterCommand;
  + if( $found ) {
  + $result.Output = $found | &amp; $removeCommand;
  + if( $? ) {
  + $result.Message = "$type removed.";
  + } else {
  + $result.Message = "$type not removed.";
  + $result.Error = $Error[0];
  + }
  + } else {
  + $result.Message = "$type not installed.";
  + }
  + $result | ConvertTo-Json -Depth 3 -Compress | Out-File -FilePath $logfile -Append -Encoding utf8;
  + }
  + "Error: $($_.Exception.Message)" | Out-File -FilePath $logfile -Append -Encoding utf8;
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Original__C__Windows_Setup_Scripts_RemoveFeatures.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 23 lines into C:\Windows\Setup\Scripts\RemoveFeatures.ps1
  + 'MediaPlayback';
  + 'Microsoft-RemoteDesktopConnection';
  + 'Recall';
  + $installed = &amp; $getCommand;
  + foreach( $selector in $selectors ) {
  + $result = [ordered] @{
  + Selector = $selector;
  + };
  + $found = $installed | Where-Object -FilterScript $filterCommand;
  + if( $found ) {
  + $result.Output = $found | &amp; $removeCommand;
  + if( $? ) {
  + $result.Message = "$type removed.";
  + } else {
  + $result.Message = "$type not removed.";
  + $result.Error = $Error[0];
  + }
  + } else {
  + $result.Message = "$type not installed.";
  + }
  + $result | ConvertTo-Json -Depth 3 -Compress | Out-File -FilePath $logfile -Append -Encoding utf8;
  + }
  + "Error: $($_.Exception.Message)" | Out-File -FilePath $logfile -Append -Encoding utf8;
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Original__C__Windows_Setup_Scripts_RemovePackages.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 60 lines into C:\Windows\Setup\Scripts\RemovePackages.ps1
  + 'Microsoft.Microsoft3DViewer';
  + 'Microsoft.BingSearch';
  + 'Microsoft.WindowsCamera';
  + 'Clipchamp.Clipchamp';
  + 'Microsoft.Copilot';
  + 'Microsoft.549981C3F5F10';
  + 'MicrosoftCorporationII.MicrosoftFamily';
  + 'Microsoft.Edge.GameAssist';
  + 'Microsoft.GetHelp';
  + 'Microsoft.Getstarted';
  + 'microsoft.windowscommunicationsapps';
  + 'Microsoft.WindowsMaps';
  + 'Microsoft.MixedReality.Portal';
  + 'Microsoft.BingNews';
  + 'Microsoft.MicrosoftOfficeHub';
  + 'Microsoft.Office.OneNote';
  + 'Microsoft.OutlookForWindows';
  + 'Microsoft.MSPaint';
  + 'Microsoft.People';
  + 'Microsoft.PowerAutomateDesktop';
  + 'MicrosoftCorporationII.QuickAssist';
  + 'Microsoft.SkypeApp';
  + 'Microsoft.ScreenSketch';
  + 'Microsoft.MicrosoftSolitaireCollection';
  + 'Microsoft.MicrosoftStickyNotes';
  + 'MicrosoftTeams';
  + 'MSTeams';
  + 'Microsoft.Todos';
  + 'Microsoft.WindowsSoundRecorder';
  + 'Microsoft.Wallet';
  + 'Microsoft.Xbox.TCUI';
  + 'Microsoft.XboxApp';
  + 'Microsoft.XboxGameOverlay';
  + 'Microsoft.XboxGamingOverlay';
  + 'Microsoft.XboxIdentityProvider';
  + 'Microsoft.XboxSpeechToTextOverlay';
  + 'Microsoft.GamingApp';
  + 'Microsoft.YourPhone';
  + 'Microsoft.ZuneMusic';
  + 'Microsoft.ZuneVideo';
  + $installed = &amp; $getCommand;
  + foreach( $selector in $selectors ) {
  + $result = [ordered] @{
  + Selector = $selector;
  + };
  + $found = $installed | Where-Object -FilterScript $filterCommand;
  + if( $found ) {
  + $result.Output = $found | &amp; $removeCommand;
  + if( $? ) {
  + $result.Message = "$type removed.";
  + } else {
  + $result.Message = "$type not removed.";
  + $result.Error = $Error[0];
  + }
  + } else {
  + $result.Message = "$type not installed.";
  + }
  + $result | ConvertTo-Json -Depth 3 -Compress | Out-File -FilePath $logfile -Append -Encoding utf8;
  + }
  + "Error: $($_.Exception.Message)" | Out-File -FilePath $logfile -Append -Encoding utf8;
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Original__C__Windows_Setup_Scripts_Specialize.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 4 lines into C:\Windows\Setup\Scripts\Specialize.ps1
  + &amp; "C:\Windows\Setup\Scripts\RemovePackages.ps1" *>> $logfile 2&gt;&amp;1
  + &amp; "C:\Windows\Setup\Scripts\RemoveCapabilities.ps1" *>> $logfile 2&gt;&amp;1
  + &amp; "C:\Windows\Setup\Scripts\RemoveFeatures.ps1" *>> $logfile 2&gt;&amp;1
  + "Specialize error: $($_.Exception.Message)" | Out-File -FilePath $logfile -Append -Encoding utf8
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Original__C__Windows_Setup_Scripts_UserOnce.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 11 lines into C:\Windows\Setup\Scripts\UserOnce.ps1
  + Invoke-WebRequest -Uri $wingetUrl -OutFile "$env:TEMP\winget.msixbundle" -UseBasicParsing *>> $logfile 2&gt;&amp;1
  + Add-AppxPackage -Path "$env:TEMP\winget.msixbundle" *>> $logfile 2&gt;&amp;1
  + winget install --id $app --silent --accept-package-agreements --accept-source-agreements *>> $logfile 2&gt;&amp;1
  + Invoke-WebRequest -Uri "https://aka.ms/vs/17/release/vc_redist.x64.exe" -OutFile "$env:TEMP\vc_redist.x64.exe" -UseBasicParsing *>> $logfile 2&gt;&amp;1
  + Start-Process -FilePath "$env:TEMP\vc_redist.x64.exe" -ArgumentList "/quiet /norestart" -Wait *>> $logfile 2&gt;&amp;1
  + Invoke-WebRequest -Uri $termUrl -OutFile "$env:TEMP\terminal.msixbundle" -UseBasicParsing *>> $logfile 2&gt;&amp;1
  + Add-AppxPackage -Path "$env:TEMP\terminal.msixbundle" *>> $logfile 2&gt;&amp;1
  + Invoke-WebRequest -Uri $vivetoolUrl -OutFile "$env:TEMP\ViVeTool.zip" -UseBasicParsing *>> $logfile 2&gt;&amp;1
  + Expand-Archive -Path "$env:TEMP\ViVeTool.zip" -DestinationPath $vivetoolPath -Force *>> $logfile 2&gt;&amp;1
  + &amp; "$vivetoolPath\vivetool.exe" /enable /id:$id *>> $logfile 2&gt;&amp;1
  + Restart-Computer -Force *>> $logfile 2&gt;&amp;1
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Schneegans__C__Windows_Setup_Scripts_DefaultUser.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 85 lines into C:\Windows\Setup\Scripts\DefaultUser.ps1
  + {
  + reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\WindowsCopilot" /v TurnOffWindowsCopilot /t REG_DWORD /d 1 /f;
  + };
  + {
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Internet Explorer\LowRegistry\Audio\PolicyConfig\PropertyStore" /f;
  + };
  + {
  + Remove-ItemProperty -LiteralPath 'Registry::HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Run' -Name 'OneDriveSetup' -Force -ErrorAction 'Continue';
  + };
  + {
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\GameDVR" /v AppCaptureEnabled /t REG_DWORD /d 0 /f;
  + };
  + {
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "HideFileExt" /t REG_DWORD /d 0 /f;
  + };
  + {
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Hidden" /t REG_DWORD /d 1 /f;
  + };
  + {
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowTaskViewButton /t REG_DWORD /d 0 /f;
  + };
  + {
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Edge\SmartScreenEnabled" /ve /t REG_DWORD /d 0 /f;
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Edge\SmartScreenPuaEnabled" /ve /t REG_DWORD /d 0 /f;
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\AppHost" /v EnableWebContentEvaluation /t REG_DWORD /d 0 /f;
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\AppHost" /v PreventOverride /t REG_DWORD /d 0 /f;
  + };
  + {
  + $names = @(
  + 'ContentDeliveryAllowed';
  + 'FeatureManagementEnabled';
  + 'OEMPreInstalledAppsEnabled';
  + 'PreInstalledAppsEnabled';
  + 'PreInstalledAppsEverEnabled';
  + 'SilentInstalledAppsEnabled';
  + 'SoftLandingEnabled';
  + 'SubscribedContentEnabled';
  + 'SubscribedContent-310093Enabled';
  + 'SubscribedContent-338387Enabled';
  + 'SubscribedContent-338388Enabled';
  + 'SubscribedContent-338389Enabled';
  + 'SubscribedContent-338393Enabled';
  + 'SubscribedContent-353694Enabled';
  + 'SubscribedContent-353696Enabled';
  + 'SubscribedContent-353698Enabled';
  + 'SystemPaneSuggestionsEnabled';
  + );
  + foreach( $name in $names ) {
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v $name /t REG_DWORD /d 0 /f;
  + }
  + };
  + {
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarAl /t REG_DWORD /d 0 /f;
  + };
  + {
  + reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\Explorer" /v DisableSearchBoxSuggestions /t REG_DWORD /d 1 /f;
  + };
  + {
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings" /v TaskbarEndTask /t REG_DWORD /d 1 /f;
  + };
  + {
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\DWM" /v ColorPrevalence /t REG_DWORD /d 0 /f;
  + };
  + {
  + reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\RunOnce" /v "UnattendedSetup" /t REG_SZ /d "powershell.exe -WindowStyle \""Hidden\"" -ExecutionPolicy \""Unrestricted\"" -NoProfi...(truncated)
  + };
  + [float] $complete = 0;
  + [float] $increment = 100 / $scripts.Count;
  + foreach( $script in $scripts ) {
  + Write-Progress -Activity 'Running scripts to modify the default user&#x2019;&#x2019;s registry hive. Do not close this window.' -PercentComplete $complete;
  + '*** Will now execute command &#xAB;{0}&#xBB;.' -f $(
  + $str = $script.ToString().Trim() -replace '\s+', ' ';
  + $max = 100;
  + if( $str.Length -le $max ) {
  + $str;
  + } else {
  + $str.Substring( 0, $max - 1 ) + '&#x2026;';
  + }
  + );
  + $start = [datetime]::Now;
  + &amp; $script;
  + '*** Finished executing command after {0:0} ms.' -f [datetime]::Now.Subtract( $start ).TotalMilliseconds;
  + "`r`n" * 3;
  + $complete += $increment;
  + }
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Schneegans__C__Windows_Setup_Scripts_FirstLogon.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 27 lines into C:\Windows\Setup\Scripts\FirstLogon.ps1
  + {
  + Set-ItemProperty -LiteralPath 'Registry::HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon' -Name 'AutoLogonCount' -Type 'DWord' -Force -Value 0;
  + };
  + {
  + @(
  + Get-ChildItem -LiteralPath 'C:\' -Force;
  + Get-ChildItem -LiteralPath 'C:\Users' -Force;
  + Get-ChildItem -LiteralPath 'C:\Users\Default' -Force -Recurse -Depth 2;
  + Get-ChildItem -LiteralPath 'C:\Users\Public' -Force -Recurse -Depth 2;
  + Get-ChildItem -LiteralPath 'C:\ProgramData' -Force;
  + ) | Where-Object -FilterScript {
  + $_.Attributes.HasFlag( [System.IO.FileAttributes]::ReparsePoint );
  + } | Remove-Item -Force -Recurse -Verbose;
  + };
  + {
  + cmd.exe /c "rmdir C:\Windows.old";
  + };
  + {
  + &amp; 'C:\Windows\Setup\Scripts\unattend-03.ps1';
  + };
  + {
  + Remove-Item -LiteralPath @(
  + 'C:\Windows\Panther\unattend.xml';
  + 'C:\Windows\Panther\unattend-original.xml';
  + 'C:\Windows\Setup\Scripts\Wifi.xml';
  + ) -Force -ErrorAction 'SilentlyContinue' -Verbose;
  + };
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Schneegans__C__Windows_Setup_Scripts_GetLockScreenImage.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 2 lines into C:\Windows\Setup\Scripts\GetLockScreenImage.ps1
  + $ProgressPreference = 'SilentlyContinue';
  + ( Invoke-WebRequest -Uri $url -UseBasicParsing -TimeoutSec 30 ).Content;
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Schneegans__C__Windows_Setup_Scripts_GetWallpaper.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 2 lines into C:\Windows\Setup\Scripts\GetWallpaper.ps1
  + $ProgressPreference = 'SilentlyContinue';
  + ( Invoke-WebRequest -Uri $url -UseBasicParsing -TimeoutSec 30 ).Content;
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Schneegans__C__Windows_Setup_Scripts_RemoveCapabilities.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 33 lines into C:\Windows\Setup\Scripts\RemoveCapabilities.ps1
  + 'Print.Fax.Scan';
  + 'Language.Handwriting';
  + 'Browser.InternetExplorer';
  + 'MathRecognizer';
  + 'OneCoreUAP.OneSync';
  + 'OpenSSH.Client';
  + 'App.Support.QuickAssist';
  + 'Language.Speech';
  + 'Language.TextToSpeech';
  + 'App.StepsRecorder';
  + 'Hello.Face.18967';
  + 'Hello.Face.Migration.18967';
  + 'Hello.Face.20134';
  + 'Media.WindowsMediaPlayer';
  + $installed = &amp; $getCommand;
  + foreach( $selector in $selectors ) {
  + $result = [ordered] @{
  + Selector = $selector;
  + };
  + $found = $installed | Where-Object -FilterScript $filterCommand;
  + if( $found ) {
  + $result.Output = $found | &amp; $removeCommand;
  + if( $? ) {
  + $result.Message = "$type removed.";
  + } else {
  + $result.Message = "$type not removed.";
  + $result.Error = $Error[0];
  + }
  + } else {
  + $result.Message = "$type not installed.";
  + }
  + $result | ConvertTo-Json -Depth 3 -Compress;
  + }
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Schneegans__C__Windows_Setup_Scripts_RemoveFeatures.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 22 lines into C:\Windows\Setup\Scripts\RemoveFeatures.ps1
  + 'MediaPlayback';
  + 'Microsoft-RemoteDesktopConnection';
  + 'Recall';
  + $installed = &amp; $getCommand;
  + foreach( $selector in $selectors ) {
  + $result = [ordered] @{
  + Selector = $selector;
  + };
  + $found = $installed | Where-Object -FilterScript $filterCommand;
  + if( $found ) {
  + $result.Output = $found | &amp; $removeCommand;
  + if( $? ) {
  + $result.Message = "$type removed.";
  + } else {
  + $result.Message = "$type not removed.";
  + $result.Error = $Error[0];
  + }
  + } else {
  + $result.Message = "$type not installed.";
  + }
  + $result | ConvertTo-Json -Depth 3 -Compress;
  + }
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Schneegans__C__Windows_Setup_Scripts_RemovePackages.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 59 lines into C:\Windows\Setup\Scripts\RemovePackages.ps1
  + 'Microsoft.Microsoft3DViewer';
  + 'Microsoft.BingSearch';
  + 'Microsoft.WindowsCamera';
  + 'Clipchamp.Clipchamp';
  + 'Microsoft.Copilot';
  + 'Microsoft.549981C3F5F10';
  + 'MicrosoftCorporationII.MicrosoftFamily';
  + 'Microsoft.Edge.GameAssist';
  + 'Microsoft.GetHelp';
  + 'Microsoft.Getstarted';
  + 'microsoft.windowscommunicationsapps';
  + 'Microsoft.WindowsMaps';
  + 'Microsoft.MixedReality.Portal';
  + 'Microsoft.BingNews';
  + 'Microsoft.MicrosoftOfficeHub';
  + 'Microsoft.Office.OneNote';
  + 'Microsoft.OutlookForWindows';
  + 'Microsoft.MSPaint';
  + 'Microsoft.People';
  + 'Microsoft.PowerAutomateDesktop';
  + 'MicrosoftCorporationII.QuickAssist';
  + 'Microsoft.SkypeApp';
  + 'Microsoft.ScreenSketch';
  + 'Microsoft.MicrosoftSolitaireCollection';
  + 'Microsoft.MicrosoftStickyNotes';
  + 'MicrosoftTeams';
  + 'MSTeams';
  + 'Microsoft.Todos';
  + 'Microsoft.WindowsSoundRecorder';
  + 'Microsoft.Wallet';
  + 'Microsoft.Xbox.TCUI';
  + 'Microsoft.XboxApp';
  + 'Microsoft.XboxGameOverlay';
  + 'Microsoft.XboxGamingOverlay';
  + 'Microsoft.XboxIdentityProvider';
  + 'Microsoft.XboxSpeechToTextOverlay';
  + 'Microsoft.GamingApp';
  + 'Microsoft.YourPhone';
  + 'Microsoft.ZuneMusic';
  + 'Microsoft.ZuneVideo';
  + $installed = &amp; $getCommand;
  + foreach( $selector in $selectors ) {
  + $result = [ordered] @{
  + Selector = $selector;
  + };
  + $found = $installed | Where-Object -FilterScript $filterCommand;
  + if( $found ) {
  + $result.Output = $found | &amp; $removeCommand;
  + if( $? ) {
  + $result.Message = "$type removed.";
  + } else {
  + $result.Message = "$type not removed.";
  + $result.Error = $Error[0];
  + }
  + } else {
  + $result.Message = "$type not installed.";
  + }
  + $result | ConvertTo-Json -Depth 3 -Compress;
  + }
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Schneegans__C__Windows_Setup_Scripts_SetColorTheme.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 39 lines into C:\Windows\Setup\Scripts\SetColorTheme.ps1
  + $params = @{
  + LiteralPath = 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize';
  + Force = $true;
  + Type = 'DWord';
  + };
  + Set-ItemProperty @params -Name 'SystemUsesLightTheme' -Value $lightThemeSystem;
  + Set-ItemProperty @params -Name 'AppsUseLightTheme' -Value $lightThemeApps;
  + Set-ItemProperty @params -Name 'ColorPrevalence' -Value $accentColorOnStart;
  + Set-ItemProperty @params -Name 'EnableTransparency' -Value $enableTransparency;
  + Add-Type -AssemblyName 'System.Drawing';
  + $accentColor = [System.Drawing.ColorTranslator]::FromHtml( $htmlAccentColor );
  + function ConvertTo-DWord {
  + param(
  + [System.Drawing.Color]
  + $Color
  + );
  + [byte[]] $bytes = @(
  + $Color.R;
  + $Color.G;
  + $Color.B;
  + $Color.A;
  + );
  + return [System.BitConverter]::ToUInt32( $bytes, 0);
  + }
  + $startColor = [System.Drawing.Color]::FromArgb( 0xD2, $accentColor );
  + Set-ItemProperty -LiteralPath 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Accent' -Name 'StartColorMenu' -Value( ConvertTo-DWord -Color $accentColor ) -Type 'DWord' -Force;
  + Set-ItemProperty -LiteralPath 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Accent' -Name 'AccentColorMenu' -Value( ConvertTo-DWord -Color $accentColor ) -Type 'DWord' -Force;
  + Set-ItemProperty -LiteralPath 'Registry::HKCU\Software\Microsoft\Windows\DWM' -Name 'AccentColor' -Value( ConvertTo-DWord -Color $accentColor ) -Type 'DWord' -Force;
  + $params = @{
  + LiteralPath = 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Accent';
  + Name = 'AccentPalette';
  + };
  + $palette = Get-ItemPropertyValue @params;
  + $index = 20;
  + $palette[ $index++ ] = $accentColor.R;
  + $palette[ $index++ ] = $accentColor.G;
  + $palette[ $index++ ] = $accentColor.B;
  + $palette[ $index++ ] = $accentColor.A;
  + Set-ItemProperty @params -Value $palette -Type 'Binary' -Force;
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Schneegans__C__Windows_Setup_Scripts_SetStartPins.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 1 lines into C:\Windows\Setup\Scripts\SetStartPins.ps1
  + return;
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Schneegans__C__Windows_Setup_Scripts_SetWallpaper.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 44 lines into C:\Windows\Setup\Scripts\SetWallpaper.ps1
  + using System.Drawing;
  + using System.Runtime.InteropServices;
  + public static class WallpaperSetter {
  + [DllImport("user32.dll")]
  + private static extern bool SetSysColors(
  + int cElements,
  + int[] lpaElements,
  + int[] lpaRgbValues
  + );
  + [DllImport("user32.dll")]
  + private static extern bool SystemParametersInfo(
  + uint uiAction,
  + uint uiParam,
  + string pvParam,
  + uint fWinIni
  + );
  + public static void SetDesktopBackground(Color color) {
  + SystemParametersInfo(20, 0, "", 0);
  + SetSysColors(1, new int[] { 1 }, new int[] { ColorTranslator.ToWin32(color) });
  + }
  + public static void SetDesktopImage(string file) {
  + SystemParametersInfo(20, 0, file, 0);
  + }
  + }
  + param(
  + [string]
  + $HtmlColor
  + );
  + $color = [System.Drawing.ColorTranslator]::FromHtml( $HtmlColor );
  + [WallpaperSetter]::SetDesktopBackground( $color );
  + Set-ItemProperty -Path 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Wallpapers' -Name 'BackgroundType' -Type 'DWord' -Value 1 -Force;
  + Set-ItemProperty -Path 'Registry::HKCU\Control Panel\Desktop' -Name 'WallPaper' -Type 'String' -Value '' -Force;
  + Set-ItemProperty -Path 'Registry::HKCU\Control Panel\Colors' -Name 'Background' -Type 'String' -Value "$($color.R) $($color.G) $($color.B)" -Force;
  + param(
  + [string]
  + $LiteralPath
  + );
  + if( $LiteralPath | Test-Path ) {
  + [WallpaperSetter]::SetDesktopImage( $LiteralPath );
  + Set-ItemProperty -Path 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Wallpapers' -Name 'BackgroundType' -Type 'DWord' -Value 0 -Force;
  + Set-ItemProperty -Path 'Registry::HKCU\Control Panel\Desktop' -Name 'WallPaper' -Type 'String' -Value $LiteralPath -Force;
  + } else {
  + "Cannot use '$LiteralPath' as a desktop wallpaper because that file does not exist.";
  + }
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Schneegans__C__Windows_Setup_Scripts_Specialize.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 117 lines into C:\Windows\Setup\Scripts\Specialize.ps1
  + {
  + reg.exe add "HKLM\SYSTEM\Setup\MoSetup" /v AllowUpgradesWithUnsupportedTPMOrCPU /t REG_DWORD /d 1 /f;
  + };
  + {
  + Remove-Item -LiteralPath 'C:\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk', 'C:\Windows\System32\OneDriveSetup.exe', 'C:\Windows\SysWOW64\OneDriveSetup.exe' -ErrorA...(truncated)
  + };
  + {
  + Remove-Item -LiteralPath 'Registry::HKLM\Software\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate' -Force -ErrorAction 'SilentlyContinue';
  + };
  + {
  + reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Communications" /v ConfigureChatAutoInstall /t REG_DWORD /d 0 /f;
  + };
  + {
  + &amp; 'C:\Windows\Setup\Scripts\RemovePackages.ps1';
  + };
  + {
  + &amp; 'C:\Windows\Setup\Scripts\RemoveCapabilities.ps1';
  + };
  + {
  + &amp; 'C:\Windows\Setup\Scripts\RemoveFeatures.ps1';
  + };
  + {
  + net.exe accounts /maxpwage:UNLIMITED;
  + };
  + {
  + reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\CI\Policy" /v VerifiedAndReputablePolicyState /t REG_DWORD /d 0 /f;
  + };
  + {
  + reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer" /v SmartScreenEnabled /t REG_SZ /d "Off" /f;
  + reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WTDS\Components" /v ServiceEnabled /t REG_DWORD /d 0 /f;
  + reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WTDS\Components" /v NotifyMalicious /t REG_DWORD /d 0 /f;
  + reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WTDS\Components" /v NotifyPasswordReuse /t REG_DWORD /d 0 /f;
  + reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WTDS\Components" /v NotifyUnsafeApp /t REG_DWORD /d 0 /f;
  + reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\Systray" /v HideSystray /t REG_DWORD /d 1 /f;
  + };
  + {
  + reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v EnableLUA /t REG_DWORD /d 0 /f
  + };
  + {
  + reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v LongPathsEnabled /t REG_DWORD /d 1 /f
  + };
  + {
  + Remove-Item -LiteralPath 'C:\Users\Public\Desktop\Microsoft Edge.lnk' -ErrorAction 'SilentlyContinue' -Verbose;
  + };
  + {
  + auditpol.exe /set /subcategory:"{0CCE922B-69AE-11D9-BED3-505054503030}" /success:enable /failure:enable;
  + };
  + {
  + reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit" /v ProcessCreationIncludeCmdLine_Enabled /t REG_DWORD /d 1 /f;
  + };
  + {
  + Set-ExecutionPolicy -Scope 'LocalMachine' -ExecutionPolicy 'RemoteSigned' -Force;
  + };
  + {
  + reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power" /v HiberbootEnabled /t REG_DWORD /d 0 /f;
  + };
  + {
  + reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Dsh" /v AllowNewsAndInterests /t REG_DWORD /d 0 /f;
  + };
  + {
  + reg.exe add "HKLM\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsConsumerFeatures" /t REG_DWORD /d 1 /f;
  + };
  + {
  + reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\BitLocker" /v "PreventDeviceEncryption" /t REG_DWORD /d 1 /f;
  + };
  + {
  + reg.exe add "HKLM\Software\Policies\Microsoft\Edge" /v HideFirstRunExperience /t REG_DWORD /d 1 /f;
  + };
  + {
  + reg.exe add "HKLM\Software\Policies\Microsoft\Edge\Recommended" /v BackgroundModeEnabled /t REG_DWORD /d 0 /f;
  + reg.exe add "HKLM\Software\Policies\Microsoft\Edge\Recommended" /v StartupBoostEnabled /t REG_DWORD /d 0 /f;
  + };
  + {
  + &amp; 'C:\Windows\Setup\Scripts\SetStartPins.ps1';
  + };
  + {
  + try {
  + $bytes = &amp; 'C:\Windows\Setup\Scripts\GetWallpaper.ps1';
  + [System.IO.File]::WriteAllBytes( 'C:\Windows\Setup\Scripts\Wallpaper', $bytes );
  + } catch {
  + $_;
  + }
  + };
  + {
  + try {
  + $bytes = &amp; 'C:\Windows\Setup\Scripts\GetLockScreenImage.ps1';
  + [System.IO.File]::WriteAllBytes( 'C:\Windows\Setup\Scripts\LockScreenImage', $bytes );
  + reg.exe add "HKLM\Software\Microsoft\Windows\CurrentVersion\PersonalizationCSP" /v LockScreenImagePath /t REG_SZ /d "C:\Windows\Setup\Scripts\LockScreenImage" /f;
  + } catch {
  + $_;
  + }
  + };
  + {
  + &amp; 'C:\Windows\Setup\Scripts\unattend-01.ps1';
  + };
  + {
  + reg.exe import "C:\Windows\Setup\Scripts\unattend-02.reg";
  + };
  + [float] $complete = 0;
  + [float] $increment = 100 / $scripts.Count;
  + foreach( $script in $scripts ) {
  + Write-Progress -Activity 'Running scripts to customize your Windows installation. Do not close this window.' -PercentComplete $complete;
  + '*** Will now execute command &#xAB;{0}&#xBB;.' -f $(
  + $str = $script.ToString().Trim() -replace '\s+', ' ';
  + $max = 100;
  + if( $str.Length -le $max ) {
  + $str;
  + } else {
  + $str.Substring( 0, $max - 1 ) + '&#x2026;';
  + }
  + );
  + $start = [datetime]::Now;
  + &amp; $script;
  + '*** Finished executing command after {0:0} ms.' -f [datetime]::Now.Subtract( $start ).TotalMilliseconds;
  + "`r`n" * 3;
  + $complete += $increment;
  + }
2026-02-13 03:55:42 [INFO] Processing diff: C:\UnattendLogs\verify_diffs\Schneegans__C__Windows_Setup_Scripts_UserOnce.ps1.diff.txt
2026-02-13 03:55:42 [INFO] Inserted 85 lines into C:\Windows\Setup\Scripts\UserOnce.ps1
  + {
  + Set-WinHomeLocation -GeoId 137;
  + };
  + {
  + Get-AppxPackage -Name 'Microsoft.Windows.Ai.Copilot.Provider' | Remove-AppxPackage;
  + };
  + {
  + @(
  + Get-ChildItem -LiteralPath $env:USERPROFILE -Force -Recurse -Depth 2;
  + ) | Where-Object -FilterScript {
  + $_.Attributes.HasFlag( [System.IO.FileAttributes]::ReparsePoint );
  + } | Remove-Item -Force -Recurse -Verbose;
  + };
  + {
  + Remove-Item -LiteralPath "${env:USERPROFILE}\Desktop\Microsoft Edge.lnk" -ErrorAction 'SilentlyContinue' -Verbose;
  + };
  + {
  + Set-ItemProperty -LiteralPath 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced' -Name 'LaunchTo' -Type 'DWord' -Value 1;
  + };
  + {
  + Set-ItemProperty -LiteralPath 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Search' -Name 'SearchboxTaskbarMode' -Type 'DWord' -Value 1;
  + };
  + {
  + New-Item -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Force;
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{5399e694-6ce5-4d6c-8fce-1d8870fdcba0}' -Value 1 -Type ...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{b4bfcc3a-db2c-424c-b029-7fe99a87c641}' -Value 1 -Type ...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{a8cdff1c-4878-43be-b5fd-f8091c1c60d0}' -Value 1 -Type ...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{374de290-123f-4565-9164-39c4925e467b}' -Value 1 -Type ...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}' -Value 1 -Type ...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{f874310e-b6b7-47dc-bc84-b9e6b38f5903}' -Value 1 -Type ...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{1cf1260c-4dd0-4ebb-811f-33c572699fde}' -Value 1 -Type ...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{f02c1a0d-be21-4350-88b0-7367fc96ef3c}' -Value 1 -Type ...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{3add1653-eb32-4cb0-bbd7-dfa0abb5acca}' -Value 1 -Type ...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{645ff040-5081-101b-9f08-00aa002f954e}' -Value 0 -Type ...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{20d04fe0-3aea-1069-a2d8-08002b30309d}' -Value 0 -Type ...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{59031a47-3f72-44a7-89c5-5595fe6b30ee}' -Value 1 -Type ...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\ClassicStartMenu' -Name '{a0953c92-50dc-43bf-be83-3742fed03c9c}' -Value 1 -Type ...(truncated)
  + New-Item -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Force;
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{5399e694-6ce5-4d6c-8fce-1d8870fdcba0}' -Value 1 -Type 'DW...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{b4bfcc3a-db2c-424c-b029-7fe99a87c641}' -Value 1 -Type 'DW...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{a8cdff1c-4878-43be-b5fd-f8091c1c60d0}' -Value 1 -Type 'DW...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{374de290-123f-4565-9164-39c4925e467b}' -Value 1 -Type 'DW...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}' -Value 1 -Type 'DW...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{f874310e-b6b7-47dc-bc84-b9e6b38f5903}' -Value 1 -Type 'DW...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{1cf1260c-4dd0-4ebb-811f-33c572699fde}' -Value 1 -Type 'DW...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{f02c1a0d-be21-4350-88b0-7367fc96ef3c}' -Value 1 -Type 'DW...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{3add1653-eb32-4cb0-bbd7-dfa0abb5acca}' -Value 1 -Type 'DW...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{645ff040-5081-101b-9f08-00aa002f954e}' -Value 0 -Type 'DW...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{20d04fe0-3aea-1069-a2d8-08002b30309d}' -Value 0 -Type 'DW...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{59031a47-3f72-44a7-89c5-5595fe6b30ee}' -Value 1 -Type 'DW...(truncated)
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel' -Name '{a0953c92-50dc-43bf-be83-3742fed03c9c}' -Value 1 -Type 'DW...(truncated)
  + };
  + {
  + Set-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Start' -Name 'VisiblePlaces' -Value $( [convert]::FromBase64String('ztU0LVr6Q0WC8iLm6vd3PC+zZ+PeiVVDv85h83...(truncated)
  + };
  + {
  + &amp; 'C:\Windows\Setup\Scripts\SetColorTheme.ps1';
  + };
  + {
  + &amp; 'C:\Windows\Setup\Scripts\SetWallpaper.ps1';
  + };
  + {
  + Get-Process -Name 'explorer' -ErrorAction 'SilentlyContinue' | Where-Object -FilterScript {
  + $_.SessionId -eq ( Get-Process -Id $PID ).SessionId;
  + } | Stop-Process -Force;
  + };
  + [float] $complete = 0;
  + [float] $increment = 100 / $scripts.Count;
  + foreach( $script in $scripts ) {
  + Write-Progress -Activity 'Running scripts to configure this user account. Do not close this window.' -PercentComplete $complete;
  + '*** Will now execute command &#xAB;{0}&#xBB;.' -f $(
  + $str = $script.ToString().Trim() -replace '\s+', ' ';
  + $max = 100;
  + if( $str.Length -le $max ) {
  + $str;
  + } else {
  + $str.Substring( 0, $max - 1 ) + '&#x2026;';
  + }
  + );
  + $start = [datetime]::Now;
  + &amp; $script;
  + '*** Finished executing command after {0:0} ms.' -f [datetime]::Now.Subtract( $start ).TotalMilliseconds;
  + "`r`n" * 3;
  + $complete += $increment;
  + }
2026-02-13 03:55:42 [INFO] Wrote restored file: C:\UnattendLogs\autounattend_Copilot_restored.xml
2026-02-13 03:55:42 [INFO] Total inserted lines: 648
2026-02-13 03:55:43 [INFO] XML parse OK for C:\UnattendLogs\autounattend_Copilot_restored.xml
